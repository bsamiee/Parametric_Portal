# RATING: 9.2/10
# CRITIQUE: Solid System 2 grounding. Explicitly calls 'sequentialthinking'. Could be improved by auto-loading 'project-memory' to avoid cold-start planning.
# INTEGRATION: Deeply wired to 'sequentialthinking' and 'architect-investigator'.
description = "Execute the rigorous 'Phase 1' planning sequence for a complex task."
usage = "plan <objective>"

[arguments]
objective = { type = "string", description = "The high-level goal or feature request" }

prompt = """
# [H1][IDENTITY]
**Role:** Gemini 3.0 Pro (Deep Think).
**Phase:** 1 (Planning & Research).

# [H1][OBJECTIVE]
Develop "Golden Path" execution plan for: "{{args.objective}}".

# [H1][TOOLS]
-   `sequentialthinking`: **MANDATORY**. Step-by-step reasoning.
-   `architect-investigator`: **REQUIRED**. Ground truth (`list_directory`, `read_file`).
-   `context7` / `exa`: Optional. External patterns.

# [H1][PROTOCOL]
1.  **COGNITIVE_PRIMING**
    -   Decompose objective via `sequentialthinking`.
    -   Identify unknowns/risks.

2.  **CONTEXT_AUDIT**
    -   Read `nx.json`, `package.json`. Graph awareness.
    -   Search codebase for existing features (DRY).
    -   Read `@GEMINI.md`. Architectural standards.

3.  **PATTERN_MATCHING**
    -   Select applicable agents from `.github/agents/`.
    -   Select applicable standards from `.gemini/standards/`.

4.  **SYNTHESIS**
    -   Draft **Step-by-Step Execution Plan**.
    -   Define **Verification Steps** (Code-as-Action).

# [H1][OUTPUT]
Produce single markdown artifact: **`PLAN.md`**.
-   **Section 1:** Context & Constraints.
-   **Section 2:** Architecture Strategy.
-   **Section 3:** Execution Steps (Atomic).
-   **Section 4:** Verification Plan.

# [H1][CONSTRAINTS]
-   **NEVER** guess. Verify with `architect-investigator`.
-   **ALWAYS** cite specific file paths.
-   **ALWAYS** follow Two-Phase Swarm Protocol.
"""