# Dynamic Agents Configuration
# Nx Cloud uses PR-size-based agent allocation for cost efficiency
# See: https://nx.dev/docs/features/ci-features/dynamic-agents
# See: https://nx.dev/docs/guides/nx-cloud/optimize-your-ttg

# Automatic retry for flaky tests - reduce CI noise
flaky-tasks:
    enabled: true
    max-retries: 2

distribute-on:
    # Small PRs (1-33% of projects affected): 3 agents (Nx Cloud minimum)
    small-changeset: 3 linux-medium-js

    # Medium PRs (34-66% of projects affected): 3 agents (balanced)
    medium-changeset: 3 linux-medium-js

    # Large PRs (67-100% of projects affected): 4 agents for speed
    large-changeset: 4 linux-medium-js
