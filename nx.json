{
    "$schema": "./node_modules/nx/schemas/nx-schema.json",
    "defaultBase": "main",
    "extends": "nx/presets/npm.json",
    "installation": {
        "plugins": {
            "@nx/js": "22.2.0-canary.20251125-7e00ec4",
            "@nx/react": "22.2.0-canary.20251125-7e00ec4",
            "@nx/vite": "22.2.0-canary.20251125-7e00ec4"
        },
        "version": "22.2.0-canary.20251125-7e00ec4"
    },
    "namedInputs": {
        "default": ["{projectRoot}/**/*", "sharedGlobals"],
        "production": [
            "default",
            "!{projectRoot}/**/?(*.)+(spec|test).[jt]s?(x)?(.snap)",
            "!{projectRoot}/tsconfig.spec.json",
            "!{projectRoot}/**/*.tsbuildinfo"
        ],
        "sharedGlobals": [
            "{workspaceRoot}/nx.json",
            "{workspaceRoot}/tsconfig.base.json",
            "{workspaceRoot}/vite.config.ts",
            "{workspaceRoot}/vitest.config.ts",
            "{workspaceRoot}/stryker.config.js",
            "{workspaceRoot}/biome.json",
            "{workspaceRoot}/package.json",
            "{workspaceRoot}/pnpm-lock.yaml",
            "{workspaceRoot}/.npmrc",
            "{workspaceRoot}/pnpm-workspace.yaml"
        ],
        "typescript": [
            "{projectRoot}/**/*.ts",
            "{projectRoot}/**/*.tsx",
            "{projectRoot}/tsconfig*.json",
            "sharedGlobals"
        ]
    },
    "nxCloudId": "6927da8c08e1be8a3c0123aa",
    "parallel": 4,
    "plugins": [
        {
            "exclude": ["vite.config.ts", "vitest.config.ts"],
            "options": {
                "buildTargetName": "build",
                "previewTargetName": "preview",
                "serveStaticTargetName": "serve-static",
                "serveTargetName": "dev",
                "testTargetName": "test"
            },
            "plugin": "@nx/vite/plugin"
        }
    ],
    "targetDefaults": {
        "analyze": {
            "cache": true,
            "dependsOn": ["build"],
            "executor": "nx:run-commands",
            "options": {
                "command": "npx serve .vite -l 8080"
            }
        },
        "build": {
            "cache": true,
            "dependsOn": ["^build"],
            "inputs": ["production", "^production"],
            "outputs": ["{projectRoot}/dist"]
        },
        "check": {
            "cache": true,
            "inputs": ["default", "sharedGlobals"]
        },
        "dev": {
            "cache": false
        },
        "inspect:build": {
            "cache": false,
            "dependsOn": ["build"],
            "executor": "nx:run-commands",
            "options": {
                "command": "npx serve .vite-inspect -l 8081"
            }
        },
        "inspect:dev": {
            "cache": false,
            "executor": "nx:run-commands",
            "options": {
                "command": "echo 'Open http://localhost:5173/__inspect/ in browser' && nx dev"
            }
        },
        "mutate": {
            "cache": false,
            "dependsOn": ["build"],
            "executor": "nx:run-commands",
            "options": {
                "command": "stryker run --incremental --testRunner vitest --coverageAnalysis perTest --reporters html,clear-text,progress --mutate 'packages/*/src/**/*.ts' --mutate '!packages/*/src/**/*.d.ts' --mutate '!packages/*/src/**/*.spec.ts'"
            }
        },
        "pwa:icons": {
            "cache": false,
            "executor": "nx:run-commands",
            "options": {
                "command": "tsx --no-warnings scripts/generate-pwa-icons.ts",
                "cwd": "{projectRoot}"
            }
        },
        "pwa:icons:watch": {
            "cache": false,
            "executor": "nx:run-commands",
            "options": {
                "command": "tsx watch scripts/generate-pwa-icons.ts",
                "cwd": "{projectRoot}"
            }
        },
        "test": {
            "cache": true,
            "inputs": ["default", "^production"],
            "outputs": ["{projectRoot}/coverage"]
        },
        "typecheck": {
            "cache": true,
            "dependsOn": ["^typecheck"],
            "inputs": ["typescript", "sharedGlobals"]
        },
        "validate:compression": {
            "cache": false,
            "dependsOn": ["build"],
            "executor": "nx:run-commands",
            "options": {
                "commands": [
                    "[ -n \"$(ls {projectRoot}/dist/entries/*.js.br 2>/dev/null)\" ] || (echo '[ERROR] Brotli files missing' && exit 1)",
                    "[ -n \"$(ls {projectRoot}/dist/entries/*.js.gz 2>/dev/null)\" ] || (echo '[ERROR] Gzip files missing' && exit 1)",
                    "echo '[OK] Compression artifacts verified'"
                ]
            }
        }
    },
    "useInferencePlugins": true,
    "workspaceLayout": { "appsDir": "apps", "libsDir": "packages" }
}
